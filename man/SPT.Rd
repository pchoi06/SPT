% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SPT.R
\name{SPT}
\alias{SPT}
\title{Sigmoidal vs. Double-Sigmoidal Model Selection Tool}
\usage{
SPT(
  dataInput,
  dataInputName = NA,
  n_runs_min_sm = 20,
  n_runs_max_sm = 500,
  n_runs_min_dsm = 20,
  n_runs_max_dsm = 500,
  showDetails = FALSE,
  startList_sm = list(h0 = 0, maximum = 1, slopeParam = 1, midPoint = 0.33),
  lowerBounds_sm = c(h0 = 0, maximum = 0.3, slopeParam = 0.01, midPoint = -0.52),
  upperBounds_sm = c(h0 = 0.3, maximum = 1.5, slopeParam = 180, midPoint = 1.15),
  min_Factor_sm = 1/2^20,
  n_iterations_sm = 1000,
  startList_dsm = list(finalAsymptoteIntensityRatio = 0.5, maximum = 1, slope1Param = 1,
    midPoint1Param = 0.33, slope2Param = 1, midPointDistanceParam = 0.29, h0 = 0.1),
  lowerBounds_dsm = c(finalAsymptoteIntensityRatio = 0, maximum = 0.3, slope1Param =
    0.01, midPoint1Param = -0.52, slope2Param = 0.01, midPointDistanceParam = 0.04, h0 =
    0),
  upperBounds_dsm = c(finalAsymptoteIntensityRatio = 1.5, maximum = 1.5, slope1Param =
    180, midPoint1Param = 1.15, slope2Param = 180, midPointDistanceParam = 0.63, h0 =
    0.3),
  min_Factor_dsm = 1/2^20,
  n_iterations_dsm = 1000,
  threshold_intensity_range = 0.1,
  threshold_minimum_for_intensity_maximum = 0.3,
  threshold_bonus_sigmoidal_AIC = 0,
  threshold_sm_tmax_IntensityRatio = 0.75,
  threshold_dsm_tmax_IntensityRatio = 0.75,
  threshold_AIC = -10,
  threshold_t0_max_int = 0.05,
  stepSize = 1e-05,
  ...
)
}
\arguments{
\item{dataInput}{A data frame (columns \code{time}, \code{intensity}) or a list with
element \code{timeIntensityData}.}

\item{dataInputName}{Optional character name for the dataset, used in the output.}

\item{n_runs_min_sm}{Minimum number of successful sigmoidal fits before stopping.}

\item{n_runs_max_sm}{Maximum total sigmoidal fit attempts.}

\item{n_runs_min_dsm}{Minimum number of successful double-sigmoidal fits before stopping.}

\item{n_runs_max_dsm}{Maximum total double-sigmoidal fit attempts.}

\item{showDetails}{Logical; if TRUE, print intermediate objects for debugging.}

\item{startList_sm, lowerBounds_sm, upperBounds_sm, min_Factor_sm, n_iterations_sm}{Sigmoidal fit control: initial guesses, optimizer bounds, minimal step factor,
and maximum iterations (passed to \code{sigFit}).}

\item{startList_dsm, lowerBounds_dsm, upperBounds_dsm, min_Factor_dsm, n_iterations_dsm}{Double-sigmoidal fit control: analogous parameters for \code{sigFit2}.}

\item{threshold_intensity_range}{Numeric; minimum data dynamic range required.}

\item{threshold_minimum_for_intensity_maximum}{Numeric; minimum peak height required.}

\item{threshold_bonus_sigmoidal_AIC}{Numeric; AIC offset favoring sigmoidal.}

\item{threshold_sm_tmax_IntensityRatio}{Numeric; ratio of sigmoidal intensity at max time.}

\item{threshold_dsm_tmax_IntensityRatio}{Numeric; ratio of double-sigmoidal intensity at max time.}

\item{threshold_AIC}{Numeric; minimum AIC improvement to accept a fit.}

\item{threshold_t0_max_int}{Numeric; maximum allowed baseline intensity.}

\item{stepSize}{Numeric; finite‐difference step for slope calculations.}

\item{...}{Additional arguments passed to underlying fit functions.}
}
\value{
A list with elements:
\describe{
\item{normalizedInput}{The normalized input data (list).}
\item{sigmoidalModel}{Data frame of sigmoidal fit parameters.}
\item{doubleSigmoidalModel}{Data frame of double-sigmoidal fit parameters.}
\item{decisionProcess}{List of logical tests and thresholds used.}
\item{summaryVector}{Named vector summarizing the chosen model and key parameters.}
}
}
\description{
Fit both a single-sigmoidal and a double-sigmoidal curve to time-intensity data,
then choose which model best describes the data—or report no signal or ambiguous.
}
